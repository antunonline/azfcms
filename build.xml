<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->


<project name="azfcms">
    <property name="output" value="${basedir}/buildOutput" />
    
    <target name="init" >
        <mkdir dir="${output}/CodeCoverage" />
    </target>
    
    <target name="clean" >
        <delete     dir="${output}" />
    </target>

    <target name="phpunit" depends="initSchema">
        <exec executable="phpunit" dir="${basedir}/tests" failonerror="true">
            <arg line="--coverage-clover ${output}/CodeCoverage/clover.xml --coverage-html ${output}/CodeCoverage/ ." />
        </exec>
    </target>

    <target name="rawphpunit" depends="initSchema">
        <exec executable="phpunit" dir="${basedir}/tests" failonerror="true">
        </exec>
    </target>
    
    <target name="initSchema">
        <exec executable="mysql">
            <arg line="-uazfcms -pazfcms " />
            <redirector inputstring="drop database azfcms" />
        </exec>
        <exec executable="mysql">
            <arg line="-uazfcms -pazfcms " />
            <redirector inputstring="CREATE database azfcms" />
        </exec>
        <exec executable="mysql" >
            <arg line="-uazfcms -pazfcms azfcms " />
            <redirector input="docs/SQL/EMPTY_SCHEMA.sql" />
        </exec>
    </target>
</project>
