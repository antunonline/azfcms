<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html>
    <head>
        <title></title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <script type="text/javascript" src="../../../dojo/dojo.js" data-dojo-config="async:true">
            
        </script>
        <script type="text/javascript">
            require(['doh','azfcms/model/cms','dojo/domReady!','dojo/_base/Deferred',
                'dojo/aspect','dojo/_base/lang','azfcms/model'],function
            (doh,cms,ready, Deferred,
            aspect, lang, model){
            
                doh.register('azfcms.tests.model.cms',[
                    {
                        name:"Test .addExtensionPlugin",
                        runTest: function(){
                            var isExprOk = false;
                            var d = new doh.Deferred();
                            
                            var expected = "cms.extensionPlugin.addExtensionPlugin(33,'name','description','type','region',400,true)";
                            var mockModel = lang.clone(model);
                            mockModel.invoke =function(actual){
                                    isExprOk = expected==actual;
                                    var d = new Deferred();
                                    d.callback(true);
                                    return d;
                                }
                            
                            cms.model = mockModel;
                            cms.addExtensionPlugin(33, "name", "description", "type", "region", 400, true).
                                then(function(){
                                doh.t(isExprOk,"Expression generated by addExtensinPlugin is not expected");
                                d.callback(true);
                                });
                            return d;
                        }
                    },
                    {
                        name:"Test .getRegionPLuginsStore",
                        runTest: function(){
                            var isExprOk = false;
                            var d = new doh.Deferred();
                            
                            var expected = "cms.extensionPlugin.getRegionExtensionPlugins(33,'left1')";
                            var mockModel = lang.clone(model);
                            mockModel.prepareLangStore =function(actual){
                                    isExprOk = expected==actual;
                                    var d = new Deferred();
                                    d.callback(true);
                                    return d;
                                }
                            
                            cms.model = mockModel;
                            cms.getRegionPluginsStore(33,'left1').then(function(){
                                doh.t(isExprOk,"Expression generated by getRegionPluginsStore is not expected");
                                d.callback(true);
                            });
                            return d;
                        }
                    },
                    {
                        name:"Test .getTemplateRegionsStore",
                        runTest: function(){
                            var isExprOk = false;
                            var d = new doh.Deferred();
                            
                            var expected = "cms.template.getTemplateRegions(33)";
                            var mockModel = lang.clone(model);
                            mockModel.prepareLangStore =function(actual){
                                    isExprOk = expected==actual;
                                    var d = new Deferred();
                                    d.callback(true);
                                    return d;
                                }
                            
                            cms.model = mockModel;
                            cms.getTemplateRegionsStore(33).then(function(){
                                doh.t(isExprOk,"Expression generated by getTemplateRegionsStore is not expected");
                                d.callback(true);
                            });
                            return d;
                        }
                    },
                    {
                        name:"Test .getExtensionPluginStore",
                        runTest: function(){
                            var isExprOk = false;
                            var d = new doh.Deferred();
                            
                            var expected = "cms.pluginDescriptor.getExtensionPlugins()";
                            var mockModel = lang.clone(model);
                            mockModel.prepareLangStore =function(actual){
                                    isExprOk = expected==actual;
                                    var d = new Deferred();
                                    d.callback(true);
                                    return d;
                                }
                            
                            cms.model = mockModel;
                            cms.getExtensionPluginStore().then(function(){
                                doh.t(isExprOk,"Expression generated by getExtensionPluginStore is not expected");
                                d.callback(true);
                            });
                            return d;
                        }
                    },
                    {
                        name:"Test .setExtensionPluginValues",
                        runTest: function(){
                            var isExprOk = false;
                            var d = new doh.Deferred();
                            
                            var expected = "cms.extensionPlugin.setExtensionPluginValues(33,22,'name','description','left',400,false)";
                            var mockModel = lang.clone(model);
                            mockModel.invoke =function(actual){
                                    isExprOk = expected==actual;
                                    var d = new Deferred();
                                    d.callback(true);
                                    return d;
                                }
                            
                            cms.model = mockModel;
                            cms.setExtensionPluginValues(33, 22, 'name', 'description', 'left',400,false).then(function(){
                                doh.t(isExprOk,"Expression generated by setExtensionPluginValues is not expected");
                                d.callback(true);
                            });
                            return d;
                        }
                    },
                    {
                        name:"Test .removeExtensionPlugin",
                        runTest: function(){
                            var isExprOk = false;
                            var d = new doh.Deferred();
                            
                            var expected = "cms.extensionPlugin.removeExtensionPlugin(33)";
                            var mockModel = lang.clone(model);
                            mockModel.invoke =function(actual){
                                    isExprOk = expected==actual;
                                    var d = new Deferred();
                                    d.callback(true);
                                    return d;
                                }
                            
                            cms.model = mockModel;
                            cms.removeExtensionPlugin(33).then(function(){
                                doh.t(isExprOk,"Expression generated by removeExtensionPlugin is not expected");
                                d.callback(true);
                            });
                            return d;
                        }
                    },
                    {
                        name:"Test .disableExtensionPlugin",
                        runTest: function(){
                            var isExprOk = false;
                            var d = new doh.Deferred();
                            
                            var expected = "cms.extensionPlugin.disableExtensionPlugin(33,44)";
                            var mockModel = lang.clone(model);
                            mockModel.invoke =function(actual){
                                    isExprOk = expected==actual;
                                    var d = new Deferred();
                                    d.callback(true);
                                    return d;
                                }
                            
                            cms.model = mockModel;
                            cms.disableExtensionPlugin(33,44).then(function(){
                                doh.t(isExprOk,"Expression generated by disableExtensionPlugin is not expected");
                                d.callback(true);
                            });
                            return d;
                        }
                    },
                    {
                        name:"Test .enableExtensionPlugin",
                        runTest: function(){
                            var isExprOk = false;
                            var d = new doh.Deferred();
                            
                            var expected = "cms.extensionPlugin.enableExtensionPlugin(33,44,400)";
                            var mockModel = lang.clone(model);
                            mockModel.invoke =function(actual){
                                    isExprOk = expected==actual;
                                    var d = new Deferred();
                                    d.callback(true);
                                    return d;
                                }
                            
                            cms.model = mockModel;
                            cms.enableExtensionPlugin(33,44,400).then(function(){
                                doh.t(isExprOk,"Expression generated by enableExtensionPlugin is not expected");
                                d.callback(true);
                            });
                            return d;
                        }
                    },
                    {
                        name:"Test .getTemplateRegionsForNavigationStore",
                        runTest: function(){
                            var isExprOk = false;
                            var d = new doh.Deferred();
                            
                            var expected = "cms.template.getTemplateRegionsForNavigation(33)";
                            var mockModel = lang.clone(model);
                            mockModel.prepareLangStore =function(actual){
                                    isExprOk = expected==actual;
                                    var d = new Deferred();
                                    d.callback(true);
                                    return d;
                                }
                            
                            cms.model = mockModel;
                            cms.getTemplateRegionsForNavigationStore(33).then(function(){
                                doh.t(isExprOk,"Expression generated by getTemplateRegionsForNavigationStore is not expected");
                                d.callback(true);
                            });
                            return d;
                        }
                    },
                    {
                        name:"Test .findPluginsByNavigationAndRegion",
                        runTest: function(){
                            var isExprOk = false;
                            var d = new doh.Deferred();
                            
                            var expected = "cms.extensionPlugin.findPluginsByNavigationAndRegion(33,'left')";
                            var mockModel = lang.clone(model);
                            mockModel.invoke =function(actual){
                                    isExprOk = expected==actual;
                                    var d = new Deferred();
                                    d.callback(true);
                                    return d;
                                }
                            
                            cms.model = mockModel;
                            cms.findPluginsByNavigationAndRegion(33,'left').then(function(){
                                doh.t(isExprOk,"Expression generated by findPluginsByNavigationAndRegion is not expected");
                                d.callback(true);
                            });
                            return d;
                        }
                    },
                    {
                        name:"Test .uploadFiles",
                        runTest:function(){
                            var isExprOk = false;
                            var d = new doh.Deferred();
                            
                            var expected = "cms.filesystem.uploadFiles({\"d\":1})";
                            var expectedForm = {}
                            var expectedDirectory = {d:1}
                            var mockModel = lang.clone(model);
                            mockModel.invokeWithForm =function(actual,form){
                                    isExprOk = expected==actual && expectedForm == form;
                                    var d = new Deferred();
                                    d.callback(true);
                                    return d;
                                }
                            
                            cms.model = mockModel;
                            cms.uploadFiles(expectedDirectory,expectedForm).then(function(){
                                doh.t(isExprOk,"Expression generated by uploadFiles is not expected");
                                d.callback(true);
                            });
                            return d;
                        }
                    }
                ]);
                doh.run();
            })
        </script>
    </head>
    <body>
        <div>DOH tests</div>
    </body>
</html>
